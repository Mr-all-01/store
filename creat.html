<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title id="title">Create Account</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <style>
    html, body {
      height: 100vh;
      min-height: 100vh;
      width: 100vw;
      max-width: none;
      margin: 0;
      padding: 0;
      overflow: auto;
    }
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      min-height: 100vh;
      width: 100vw;
      max-width: 200vw;
      background: #f6f6f6;
      font-family: 'Times New Roman', Times, serif;
      margin: 0;
      padding: 0;
    }
    
    .form-container {
      background: #ffffff;
      padding: 20px 30px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      max-width: 900px;
      width: 100%;
      max-height: 98vh;
      overflow: auto;
    }
    @media (min-width: 1000px) {
      .responsive-element {
        width: 800px;
        max-width: 90vw;
      }
    }
    @media(max-width: 600px) {
      .form-container {
        max-width: none;
        width: 95vw;
        padding: 16px 2vw;
        min-width: 0;
      }
      body {
        align-items: flex-start;
        padding-top: 10px;
      }
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      color: #333;
    }
    label {
      display: block;
      margin: 10px 0 5px;
    }
    .Gs {
      display: flex;
      flex-direction: row !important;
      align-items: center;
    }
    .Gss {
      display: flex;
      flex-direction: row;
      gap: 32px;
    }
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="tel"] {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 15px;
      box-sizing: border-box;
      font-size: 1rem;
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      color: white;
      font-size: 1rem;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s;
      background-color: #05107779;
    }
    button:hover,
    #submit-btn:hover {
      background-color:aquamarine;
      
    }
    .lang-toggle {
      margin-bottom: 10px;
      float: right;
      background-color: #05107779;
    }
    .hidden, .hidding {
      display: none !important;
    }
    .error-message {
      color: red;
      text-align: center;
      margin-top: 10px;
      min-height: 22px;
    }
    .success-message {
      color: green;
      text-align: center;
      margin-top: 10px;
      min-height: 22px;
    }
    /* Clearfix for lang-toggle */
    .clearfix::after {
      content: "";
      clear: both;
      display: table;
    }

    
    #close-modal {
      width:150px;
      right: 28.5%;
      align-self: center;
    
      
    }
    .modal-overlay {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.2);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    .modal-overlay.active {
      display: flex;
    }
    .modal-circle {
      width: 350px;
      height: 350px;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 2px 20px rgba(0,0,0,0.15);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      animation: pop-in 0.3s ease;
    }
    @keyframes pop-in {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .close-modal {
      position: absolute;
      top: 15px;
      right: 17px;
      background: transparent;
      border: none;
      font-size: 1.5em;
      color: #888;
      cursor: pointer;
    }
  </style>
</head>
<body>
  
    <div class="form-container">
      <div class="clearfix">
        <button id="lang-toggle" class="lang-toggle">العربية</button>
      </div>
      <h2 id="form-title">Create Account</h2>
      <form id="createForm" autocomplete="off" novalidate>
        <label for="firstName" id="label-firstName">First Name</label>
        <input type="text" id="firstName" name="firstName" required>

        <label for="lastName" id="label-lastName">Last Name</label>
        <input type="text" id="lastName" name="lastName" required>

        <div id="gender-container">
          <label id="label-gender">Gender</label>
          <div class="Gss">
            <div class="Gs">
              <input type="radio" id="male" name="gender" value="male" required>
              <label for="male" id="label-male">Male</label>
            </div>
            <div class="Gs">
              <input type="radio" id="female" name="gender" value="female">
              <label for="female" id="label-female">Female</label>
            </div>
          </div>
        </div>

        <label id="confirm">Contact Information</label>
        <div class="Gss">
          <div class="Gs">
            <input type="radio" id="email-B" name="confirm" value="email" checked>
            <label for="email-B" id="email-BM">Email</label>
          </div>
          <div class="Gs">
            <input type="radio" id="phone-B" name="confirm" value="phone">
            <label for="phone-B" id="phone-BM">Phone Number</label>
          </div>
        </div>

        <div id="email-field">
          <label for="email" id="label-email">Email</label>
          <input type="email" id="email" name="email" autocomplete="off">
        </div>
        <div id="phone-field" class="hidden">
          <label for="pM" id="label-number">Phone Number</label>
          <input type="tel" id="pM" maxlength="10" minlength="9" pattern="^0[567][0-9]{8,9}$" autocomplete="off" placeholder="06/07/08 XX XX XX XX">
        </div>

        <label for="password" id="label-password">Password</label>
        <input type="password" id="password" name="password" required>

        <label for="password2" id="label-password2">Retype Password</label>
        <input type="password" id="password2" name="password2" required>

        <div class="Gs">
          <input id="agree" type="checkbox" required name="agree">
          <label for="agree" id="label-agree">I read and agree to <a href="about_us.html#privacy-policy" target="_blank">privacy policy</a></label>
        </div>

        <button type="submit" id="submit-btn">Create Account</button>
        <div id="success-message" class="success-message"></div>
        <div id="error-message" class="error-message"></div>
      </form>
    </div>
  </div>

  <div class="modal-overlay" id="modal">
    <div class="modal-circle">
      <button class="close-modal" id="close-modal" title="Close">&times;</button>
      <form id="confirmForm" autocomplete="off">
        <div class="form-group">
          <label for="confirm-input" id="confirm-label">Confirm Email or Phone:</label>
          <input type="text" id="confirm-input" name="confirm-input" required>
        </div>
        <button type="submit" id="confirm-submit">Submit</button>
      </form>
    </div>

  <script>
    let isArabic = false;

    const TEXTS = {
      en: {
        title: "Create Account",
        formTitle: "Create Account",
        firstName: "First Name",
        lastName: "Last Name",
        gender: "Gender",
        male: "Male",
        female: "Female",
        Con: "Contact Information",
        email: "Email",
        password: "Password",
        password2: "Retype Password",
        submit: "Create Account",
        success: "Account created successfully!",
        error: "Please fill out all fields correctly.",
        passwordShort: "Password must be at least 6 characters.",
        passwordWeak: "Password must contain a number and a letter.",
        passwordNotMatch: "Passwords do not match.",
        agree: 'I read and agree to <a href="about_us.html#privacy-policy" target="_blank">privacy policy</a>',
        number: "Phone Number",
        number2: "Starts with 06, 07, or 05",
        langToggle: "العربية",
        confirmLabel: "Confirm Email or Phone:",
        confirmError: "Email or phone does not match!",
        accountCreated: "Account created successfully!"
      },
      ar: {
        title: "إنشاء حساب",
        formTitle: "إنشاء حساب",
        firstName: "الاسم",
        lastName: "اللقب",
        gender: "الجنس",
        male: "ذكر",
        female: "أنثى",
        Con: "معلومات التواصل",
        email: "البريد الإلكتروني",
        password: "كلمة المرور",
        password2: "أعد كتابة كلمة المرور",
        submit: "إنشاء الحساب",
        success: "تم إنشاء الحساب بنجاح!",
        error: "يرجى تعبئة جميع الحقول بشكل صحيح.",
        passwordShort: "يجب أن تكون كلمة المرور 6 أحرف على الأقل.",
        passwordWeak: "يجب أن تحتوي كلمة المرور على الاقل على رقم وحرف.",
        passwordNotMatch: "لايوجد تطابق بين كلمتي المرور.",
        number: "رقم الهاتف",
        number2: "يبدأ بـ 06 أو 07 أو 05",
        agree: 'لقد قرأت <a href="about_us.html#privacy-policy" target="_blank">سياسة الخصوصية</a> ووافقت عليها',
        langToggle: "English",
        confirmLabel: "تأكيد البريد الإلكتروني أو رقم الهاتف:",
        confirmError: "البريد الإلكتروني أو رقم الهاتف غير متطابق!",
        accountCreated: "تم إنشاء الحساب بنجاح!"
      }
    };

    function updateLanguage() {
      const A = isArabic ? TEXTS.ar : TEXTS.en;
      document.documentElement.lang = isArabic ? "ar" : "en";
      document.body.dir = isArabic ? "rtl" : "ltr";
      document.getElementById("title").textContent = A.title;
      document.getElementById("form-title").textContent = A.formTitle;
      document.getElementById("label-firstName").textContent = A.firstName;
      document.getElementById("firstName").placeholder = A.firstName;
      document.getElementById("label-lastName").textContent = A.lastName;
      document.getElementById("lastName").placeholder = A.lastName;
      document.getElementById("label-gender").textContent = A.gender;
      document.getElementById("label-male").textContent = A.male;
      document.getElementById("label-female").textContent = A.female;
      document.getElementById("confirm").textContent = A.Con;
      document.getElementById("email-BM").textContent = A.email;
      document.getElementById("phone-BM").textContent = A.number;
      document.getElementById("label-email").textContent = A.email;
      document.getElementById("email").placeholder = A.email;
      document.getElementById("label-password").textContent = A.password;
      document.getElementById("password").placeholder = A.password;
      document.getElementById("label-password2").textContent = A.password2;
      document.getElementById("password2").placeholder = A.password2;
      document.getElementById("submit-btn").textContent = A.submit;
      document.getElementById("lang-toggle").textContent = A.langToggle;
      document.getElementById("label-number").textContent = A.number;
      document.getElementById("pM").placeholder =  isArabic ? '06/07/05 XX XX XX XX' : '06/07/05 XX XX XX XX';
      document.getElementById("label-agree").innerHTML = A.agree;
      document.getElementById("success-message").textContent = "";
      document.getElementById("error-message").textContent = "";
      document.getElementById("confirm-label").textContent = A.confirmLabel;
    }

    // Toggle language
    document.getElementById("lang-toggle").addEventListener("click", function() {
      isArabic = !isArabic;
      updateLanguage();
    });

    // Show/hide email or phone fields
    function toggleContactFields() {
      const emailRadio = document.getElementById('email-B').checked;
      const phoneRadio = document.getElementById('phone-B').checked;
      document.getElementById('email-field').classList.toggle('hidden', !emailRadio);
      document.getElementById('email').required = emailRadio;
      document.getElementById('phone-field').classList.toggle('hidden', !phoneRadio);
      document.getElementById('pM').required = phoneRadio;
    }
    document.getElementById('email-B').addEventListener('change', toggleContactFields);
    document.getElementById('phone-B').addEventListener('change', toggleContactFields);

    // Password verification function
    function verifyPassword(pw) {
      if (pw.length < 6) return "short";
      if (!(/[a-zA-Z]/.test(pw) && /\d/.test(pw))) return "weak";
      return "ok";
    }

    // Phone validation
    function validatePhone(phone) {
      return /^0[567][0-9]{7,8}$/.test(phone);
    }

    // Save registration info for confirmation step
    let registrationContactValue = "";

    // Form submit
    document.getElementById("createForm").addEventListener("submit", function(event) {
      event.preventDefault();
      const t = isArabic ? TEXTS.ar : TEXTS.en;

      // Validate all fields
      const firstName = document.getElementById("firstName").value.trim();
      const lastName = document.getElementById("lastName").value.trim();
      const genderMale = document.getElementById("male").checked;
      const genderFemale = document.getElementById("female").checked;
      const contactChoice = document.querySelector('input[name="confirm"]:checked').value;
      const email = document.getElementById("email").value.trim();
      const phone = document.getElementById("pM").value.trim();
      const password = document.getElementById("password").value;
      const password2 = document.getElementById("password2").value;
      const agree = document.getElementById("agree").checked;

      const errorMsg = document.getElementById("error-message");
      const successMsg = document.getElementById("success-message");
      errorMsg.textContent = "";
      successMsg.textContent = "";

      // Validate required fields
      if (!firstName || !lastName || !(genderMale || genderFemale) || !agree) {
        errorMsg.textContent = t.error;
        return;
      }
      if (contactChoice === "email") {
        if (!email) {
          errorMsg.textContent = t.error;
          return;
        }
        if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
          errorMsg.textContent = t.error;
          return;
        }
      }
      if (contactChoice === "phone") {
        if (!phone) {
          errorMsg.textContent = t.error;
          return;
        }
        if (!validatePhone(phone)) {
          errorMsg.textContent = t.number2 || t.error;
          return;
        }
      }
      if (!password || !password2) {
        errorMsg.textContent = t.error;
        return;
      }
      if (password !== password2) {
        errorMsg.textContent = t.passwordNotMatch;
        return;
      }
      const pwStatus = verifyPassword(password);
      if (pwStatus === "short") {
        errorMsg.textContent = t.passwordShort;
        return;
      }
      if (pwStatus === "weak") {
        errorMsg.textContent = t.passwordWeak;
        return;
      }

      // Save contact value for confirmation modal
      registrationContactValue = (contactChoice === "email") ? email : phone;

      // Show confirm modal
      document.getElementById("modal").classList.add("active");
      document.getElementById("confirm-input").value = "";
      document.getElementById("confirm-input").focus();
    });

    // Initial setup
    updateLanguage();
    toggleContactFields();

    // Modal confirm logic
    const modal = document.getElementById('modal');
    const closeModalBtn = document.getElementById('close-modal');
    const confirmForm = document.getElementById('confirmForm');
    const confirmInput = document.getElementById('confirm-input');

    closeModalBtn.addEventListener('click', () => {
      modal.classList.remove('active');
    });

    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.classList.remove('active');
      }
    });

    confirmForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const t = isArabic ? TEXTS.ar : TEXTS.en;
      if (confirmInput.value.trim() !== registrationContactValue) {
        alert(t.confirmError);
        confirmInput.focus();
        return;
      }
      // Success: Account created
      modal.classList.remove('active');
      alert(t.accountCreated);
      // Redirect to home page
      window.location.href = "home.html";
    });
  </script>
</body>
</html>
